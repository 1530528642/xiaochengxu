'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var daaty = require("../../utils/api2.js");
exports.default = Page({
  data: {
    navList: [],
    goodsList: [],
    id: 0,
    currentCategory: {},
    scrollLeft: 0,
    scrollTop: 0,
    scrollHeight: 0,
    offset: 0,
    limit: 10
  },
  onLoad: function onLoad(options) {
    // 页面初始化 options为页面跳转所带来的参数
    var that = this;
    if (options.id) {
      that.setData({
        id: parseInt(options.id)
      });
    }

    wx.getSystemInfo({
      success: function success(res) {
        that.setData({
          scrollHeight: res.windowHeight
        });
      }
    });

    this.getCategoryInfo();
  },
  getCategoryInfo: function getCategoryInfo() {
    var that = this;
    daaty.GoodsCategory(that.data.id, null, successFay);
    function successFay(res, sourceObj) {
      // if (res.errno == 0) {
      that.setData({
        navList: res.data.brotherCategory,
        currentCategory: res.data.currentCategory
      });

      wx.setNavigationBarTitle({
        title: res.data.parentCategory.name
      });

      //nav位置
      var currentIndex = 0;
      var navListCount = that.data.navList.length;
      for (var i = 0; i < navListCount; i++) {
        currentIndex += 1;
        if (that.data.navList[i].id == that.data.id) {
          break;
        }
      }
      if (currentIndex > navListCount / 2 && navListCount > 5) {
        that.setData({
          scrollLeft: currentIndex * 60
        });
      }
      console.log(11111111);
      that.getGoodsList();
    }
  },
  onReady: function onReady() {
    // 页面渲染完成
  },
  onShow: function onShow() {
    // 页面显示
    console.log(1);
  },
  onHide: function onHide() {
    // 页面隐藏
  },
  getGoodsList: function getGoodsList() {
    var that = this;
    daaty.GoodsList(that.data.id, '', '', '', '', '', '', that.data.offset, that.data.limit, null, successFay);
    function successFay(res, sourceObj) {
      that.setData({
        goodsList: res.data.goodsList
      });
    }
  },
  onUnload: function onUnload() {
    // 页面关闭
  },
  switchCate: function switchCate(event) {
    if (this.data.id == event.currentTarget.dataset.id) {
      return false;
    }
    var that = this;
    var clientX = event.detail.x;
    var currentTarget = event.currentTarget;
    if (clientX < 60) {
      that.setData({
        scrollLeft: currentTarget.offsetLeft - 60
      });
    } else if (clientX > 330) {
      that.setData({
        scrollLeft: currentTarget.offsetLeft
      });
    }
    this.setData({
      id: event.currentTarget.dataset.id
    });

    this.getCategoryInfo();
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhdGVnb3J5Lnd4cCJdLCJuYW1lcyI6WyJkYWF0eSIsInJlcXVpcmUiLCJkYXRhIiwibmF2TGlzdCIsImdvb2RzTGlzdCIsImlkIiwiY3VycmVudENhdGVnb3J5Iiwic2Nyb2xsTGVmdCIsInNjcm9sbFRvcCIsInNjcm9sbEhlaWdodCIsIm9mZnNldCIsImxpbWl0Iiwib25Mb2FkIiwib3B0aW9ucyIsInRoYXQiLCJzZXREYXRhIiwicGFyc2VJbnQiLCJ3eCIsImdldFN5c3RlbUluZm8iLCJzdWNjZXNzIiwicmVzIiwid2luZG93SGVpZ2h0IiwiZ2V0Q2F0ZWdvcnlJbmZvIiwiR29vZHNDYXRlZ29yeSIsInN1Y2Nlc3NGYXkiLCJzb3VyY2VPYmoiLCJicm90aGVyQ2F0ZWdvcnkiLCJzZXROYXZpZ2F0aW9uQmFyVGl0bGUiLCJ0aXRsZSIsInBhcmVudENhdGVnb3J5IiwibmFtZSIsImN1cnJlbnRJbmRleCIsIm5hdkxpc3RDb3VudCIsImxlbmd0aCIsImkiLCJjb25zb2xlIiwibG9nIiwiZ2V0R29vZHNMaXN0Iiwib25SZWFkeSIsIm9uU2hvdyIsIm9uSGlkZSIsIkdvb2RzTGlzdCIsIm9uVW5sb2FkIiwic3dpdGNoQ2F0ZSIsImV2ZW50IiwiY3VycmVudFRhcmdldCIsImRhdGFzZXQiLCJjbGllbnRYIiwiZGV0YWlsIiwieCIsIm9mZnNldExlZnQiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBTUEsUUFBU0MsUUFBUSxxQkFBUixDQUFmOztBQU1FQyxRQUFNO0FBQ0pDLGFBQVMsRUFETDtBQUVKQyxlQUFXLEVBRlA7QUFHSkMsUUFBSSxDQUhBO0FBSUpDLHFCQUFpQixFQUpiO0FBS0pDLGdCQUFZLENBTFI7QUFNSkMsZUFBVyxDQU5QO0FBT0pDLGtCQUFjLENBUFY7QUFRSkMsWUFBUSxDQVJKO0FBU0pDLFdBQU87QUFUSCxHO0FBV05DLFVBQVEsZ0JBQVVDLE9BQVYsRUFBbUI7QUFDekI7QUFDQSxRQUFJQyxPQUFPLElBQVg7QUFDQSxRQUFJRCxRQUFRUixFQUFaLEVBQWdCO0FBQ2RTLFdBQUtDLE9BQUwsQ0FBYTtBQUNYVixZQUFJVyxTQUFTSCxRQUFRUixFQUFqQjtBQURPLE9BQWI7QUFHRDs7QUFFRFksT0FBR0MsYUFBSCxDQUFpQjtBQUNmQyxlQUFTLGlCQUFVQyxHQUFWLEVBQWU7QUFDdEJOLGFBQUtDLE9BQUwsQ0FBYTtBQUNYTix3QkFBY1csSUFBSUM7QUFEUCxTQUFiO0FBR0Q7QUFMYyxLQUFqQjs7QUFTQSxTQUFLQyxlQUFMO0FBRUQsRztBQUNEQSxtQkFBaUIsMkJBQVk7QUFDM0IsUUFBSVIsT0FBTyxJQUFYO0FBQ0FkLFVBQU11QixhQUFOLENBQW9CVCxLQUFLWixJQUFMLENBQVVHLEVBQTlCLEVBQWlDLElBQWpDLEVBQXNDbUIsVUFBdEM7QUFDQyxhQUFTQSxVQUFULENBQW9CSixHQUFwQixFQUF5QkssU0FBekIsRUFBbUM7QUFDNUI7QUFDRlgsV0FBS0MsT0FBTCxDQUFhO0FBQ1haLGlCQUFTaUIsSUFBSWxCLElBQUosQ0FBU3dCLGVBRFA7QUFFWHBCLHlCQUFpQmMsSUFBSWxCLElBQUosQ0FBU0k7QUFGZixPQUFiOztBQUtBVyxTQUFHVSxxQkFBSCxDQUF5QjtBQUN2QkMsZUFBT1IsSUFBSWxCLElBQUosQ0FBUzJCLGNBQVQsQ0FBd0JDO0FBRFIsT0FBekI7O0FBSUE7QUFDQSxVQUFJQyxlQUFlLENBQW5CO0FBQ0EsVUFBSUMsZUFBZWxCLEtBQUtaLElBQUwsQ0FBVUMsT0FBVixDQUFrQjhCLE1BQXJDO0FBQ0EsV0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLFlBQXBCLEVBQWtDRSxHQUFsQyxFQUF1QztBQUNyQ0gsd0JBQWdCLENBQWhCO0FBQ0EsWUFBSWpCLEtBQUtaLElBQUwsQ0FBVUMsT0FBVixDQUFrQitCLENBQWxCLEVBQXFCN0IsRUFBckIsSUFBMkJTLEtBQUtaLElBQUwsQ0FBVUcsRUFBekMsRUFBNkM7QUFDM0M7QUFDRDtBQUNGO0FBQ0QsVUFBSTBCLGVBQWVDLGVBQWUsQ0FBOUIsSUFBbUNBLGVBQWUsQ0FBdEQsRUFBeUQ7QUFDdkRsQixhQUFLQyxPQUFMLENBQWE7QUFDWFIsc0JBQVl3QixlQUFlO0FBRGhCLFNBQWI7QUFHRDtBQUNESSxjQUFRQyxHQUFSLENBQVksUUFBWjtBQUNBdEIsV0FBS3VCLFlBQUw7QUFFSjtBQUNILEc7QUFDREMsV0FBUyxtQkFBWTtBQUNuQjtBQUNELEc7QUFDREMsVUFBUSxrQkFBWTtBQUNsQjtBQUNBSixZQUFRQyxHQUFSLENBQVksQ0FBWjtBQUNELEc7QUFDREksVUFBUSxrQkFBWTtBQUNsQjtBQUNELEc7QUFDREgsZ0JBQWMsd0JBQVk7QUFDeEIsUUFBSXZCLE9BQU8sSUFBWDtBQUNGZCxVQUFNeUMsU0FBTixDQUFnQjNCLEtBQUtaLElBQUwsQ0FBVUcsRUFBMUIsRUFBNkIsRUFBN0IsRUFBZ0MsRUFBaEMsRUFBbUMsRUFBbkMsRUFBc0MsRUFBdEMsRUFBeUMsRUFBekMsRUFBNEMsRUFBNUMsRUFBK0NTLEtBQUtaLElBQUwsQ0FBVVEsTUFBekQsRUFBZ0VJLEtBQUtaLElBQUwsQ0FBVVMsS0FBMUUsRUFBZ0YsSUFBaEYsRUFBcUZhLFVBQXJGO0FBQ0csYUFBU0EsVUFBVCxDQUFvQkosR0FBcEIsRUFBeUJLLFNBQXpCLEVBQW1DO0FBQ2hDWCxXQUFLQyxPQUFMLENBQWE7QUFDWFgsbUJBQVdnQixJQUFJbEIsSUFBSixDQUFTRTtBQURULE9BQWI7QUFHRjtBQUNILEc7QUFDRHNDLFlBQVUsb0JBQVk7QUFDcEI7QUFDRCxHO0FBQ0RDLGNBQVksb0JBQVVDLEtBQVYsRUFBaUI7QUFDM0IsUUFBSSxLQUFLMUMsSUFBTCxDQUFVRyxFQUFWLElBQWdCdUMsTUFBTUMsYUFBTixDQUFvQkMsT0FBcEIsQ0FBNEJ6QyxFQUFoRCxFQUFvRDtBQUNsRCxhQUFPLEtBQVA7QUFDRDtBQUNELFFBQUlTLE9BQU8sSUFBWDtBQUNBLFFBQUlpQyxVQUFVSCxNQUFNSSxNQUFOLENBQWFDLENBQTNCO0FBQ0EsUUFBSUosZ0JBQWdCRCxNQUFNQyxhQUExQjtBQUNBLFFBQUlFLFVBQVUsRUFBZCxFQUFrQjtBQUNoQmpDLFdBQUtDLE9BQUwsQ0FBYTtBQUNYUixvQkFBWXNDLGNBQWNLLFVBQWQsR0FBMkI7QUFENUIsT0FBYjtBQUdELEtBSkQsTUFJTyxJQUFJSCxVQUFVLEdBQWQsRUFBbUI7QUFDeEJqQyxXQUFLQyxPQUFMLENBQWE7QUFDWFIsb0JBQVlzQyxjQUFjSztBQURmLE9BQWI7QUFHRDtBQUNELFNBQUtuQyxPQUFMLENBQWE7QUFDWFYsVUFBSXVDLE1BQU1DLGFBQU4sQ0FBb0JDLE9BQXBCLENBQTRCekM7QUFEckIsS0FBYjs7QUFJQSxTQUFLaUIsZUFBTDtBQUNEIiwiZmlsZSI6ImNhdGVnb3J5Lnd4cCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRhYXR5ID0gIHJlcXVpcmUoXCIuLi8uLi91dGlscy9hcGkyLmpzXCIpXG5leHBvcnQgZGVmYXVsdCB7XG4gIGNvbmZpZzoge1xuICAgIG5hdmlnYXRpb25CYXJUaXRsZVRleHQ6ICfphY3ku7YnLFxuICAgIHVzaW5nQ29tcG9uZW50czoge31cbiAgfSxcbiAgZGF0YToge1xuICAgIG5hdkxpc3Q6IFtdLFxuICAgIGdvb2RzTGlzdDogW10sXG4gICAgaWQ6IDAsXG4gICAgY3VycmVudENhdGVnb3J5OiB7fSxcbiAgICBzY3JvbGxMZWZ0OiAwLFxuICAgIHNjcm9sbFRvcDogMCxcbiAgICBzY3JvbGxIZWlnaHQ6IDAsXG4gICAgb2Zmc2V0OiAwLFxuICAgIGxpbWl0OiAxMFxuICB9LFxuICBvbkxvYWQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgLy8g6aG16Z2i5Yid5aeL5YyWIG9wdGlvbnPkuLrpobXpnaLot7PovazmiYDluKbmnaXnmoTlj4LmlbBcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgaWYgKG9wdGlvbnMuaWQpIHtcbiAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgIGlkOiBwYXJzZUludChvcHRpb25zLmlkKVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgd3guZ2V0U3lzdGVtSW5mbyh7XG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgc2Nyb2xsSGVpZ2h0OiByZXMud2luZG93SGVpZ2h0XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICB0aGlzLmdldENhdGVnb3J5SW5mbygpO1xuXG4gIH0sXG4gIGdldENhdGVnb3J5SW5mbzogZnVuY3Rpb24gKCkge1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICBkYWF0eS5Hb29kc0NhdGVnb3J5KHRoYXQuZGF0YS5pZCxudWxsLHN1Y2Nlc3NGYXkpXG4gICAgIGZ1bmN0aW9uIHN1Y2Nlc3NGYXkocmVzLCBzb3VyY2VPYmope1xuICAgICAgICAgICAgLy8gaWYgKHJlcy5lcnJubyA9PSAwKSB7XG4gICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgIG5hdkxpc3Q6IHJlcy5kYXRhLmJyb3RoZXJDYXRlZ29yeSxcbiAgICAgICAgICAgIGN1cnJlbnRDYXRlZ29yeTogcmVzLmRhdGEuY3VycmVudENhdGVnb3J5XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB3eC5zZXROYXZpZ2F0aW9uQmFyVGl0bGUoe1xuICAgICAgICAgICAgdGl0bGU6IHJlcy5kYXRhLnBhcmVudENhdGVnb3J5Lm5hbWVcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgLy9uYXbkvY3nva5cbiAgICAgICAgICBsZXQgY3VycmVudEluZGV4ID0gMDtcbiAgICAgICAgICBsZXQgbmF2TGlzdENvdW50ID0gdGhhdC5kYXRhLm5hdkxpc3QubGVuZ3RoO1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmF2TGlzdENvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGN1cnJlbnRJbmRleCArPSAxO1xuICAgICAgICAgICAgaWYgKHRoYXQuZGF0YS5uYXZMaXN0W2ldLmlkID09IHRoYXQuZGF0YS5pZCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA+IG5hdkxpc3RDb3VudCAvIDIgJiYgbmF2TGlzdENvdW50ID4gNSkge1xuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgICAgc2Nyb2xsTGVmdDogY3VycmVudEluZGV4ICogNjBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zb2xlLmxvZygxMTExMTExMSlcbiAgICAgICAgICB0aGF0LmdldEdvb2RzTGlzdCgpO1xuXG4gICAgIH1cbiAgfSxcbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuICAgIC8vIOmhtemdoua4suafk+WujOaIkFxuICB9LFxuICBvblNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyDpobXpnaLmmL7npLpcbiAgICBjb25zb2xlLmxvZygxKTtcbiAgfSxcbiAgb25IaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8g6aG16Z2i6ZqQ6JePXG4gIH0sXG4gIGdldEdvb2RzTGlzdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgZGFhdHkuR29vZHNMaXN0KHRoYXQuZGF0YS5pZCwnJywnJywnJywnJywnJywnJyx0aGF0LmRhdGEub2Zmc2V0LHRoYXQuZGF0YS5saW1pdCxudWxsLHN1Y2Nlc3NGYXkpXG4gICAgIGZ1bmN0aW9uIHN1Y2Nlc3NGYXkocmVzLCBzb3VyY2VPYmope1xuICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgIGdvb2RzTGlzdDogcmVzLmRhdGEuZ29vZHNMaXN0LFxuICAgICAgICB9KTtcbiAgICAgfVxuICB9LFxuICBvblVubG9hZDogZnVuY3Rpb24gKCkge1xuICAgIC8vIOmhtemdouWFs+mXrVxuICB9LFxuICBzd2l0Y2hDYXRlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5kYXRhLmlkID09IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdmFyIGNsaWVudFggPSBldmVudC5kZXRhaWwueDtcbiAgICB2YXIgY3VycmVudFRhcmdldCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgaWYgKGNsaWVudFggPCA2MCkge1xuICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgc2Nyb2xsTGVmdDogY3VycmVudFRhcmdldC5vZmZzZXRMZWZ0IC0gNjBcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoY2xpZW50WCA+IDMzMCkge1xuICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgc2Nyb2xsTGVmdDogY3VycmVudFRhcmdldC5vZmZzZXRMZWZ0XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGlkOiBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaWRcbiAgICB9KTtcblxuICAgIHRoaXMuZ2V0Q2F0ZWdvcnlJbmZvKCk7XG4gIH1cbn0iXX0=