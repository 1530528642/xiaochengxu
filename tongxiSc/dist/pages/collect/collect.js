'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var daaty = require("../../utils/api2.js");
var app = getApp();
exports.default = Page({
  data: {
    type: 0,
    collectList: [],
    offset: 0,
    limit: 10,
    totalPages: 1
  },
  getCollectList: function getCollectList() {
    wx.showLoading({
      title: '加载中...'
    });
    var that = this;
    daaty.CollectList(that.data.type, that.data.offset, that.data.limit, null, successFay);
    function successFay(res, sourceObj) {
      console.log(res.data.collectList);
      that.setData({
        collectList: that.data.collectList.concat(res.data.collectList),
        totalPages: res.data.totalPages
      });
      wx.hideLoading();
    }
  },

  onLoad: function onLoad(options) {
    var userid = app.globalData.user.userId;
    this.setData({ userid: userid });
    this.getCollectList();
  },
  onReachBottom: function onReachBottom() {
    if (this.data.totalPages > this.data.page) {
      this.setData({
        page: this.data.page + 1
      });
      this.getCollectList();
    } else {
      wx.showToast({
        title: '没有更多用户收藏了',
        icon: 'none',
        duration: 2000
      });
      return false;
    }
  },

  onReady: function onReady() {},
  onShow: function onShow() {},
  onHide: function onHide() {
    // 页面隐藏

  },
  onUnload: function onUnload() {
    // 页面关闭
  },
  openGoods: function openGoods(event) {

    var that = this;
    var index = event.currentTarget.dataset.index;
    var goodsId = this.data.collectList[index].valueId;

    //触摸时间距离页面打开的毫秒数  
    var touchTime = that.data.touchEnd - that.data.touchStart;
    //如果按下时间大于350为长按  
    if (touchTime > 350) {
      wx.showModal({
        title: '',
        content: '确定删除吗？',
        success: function success(res) {
          if (res.confirm) {
            var successFay = function successFay(res, sourceObj) {
              wx.showToast({
                title: '删除成功',
                icon: 'success',
                duration: 2000
              });
              that.data.collectList.splice(index, 1);
              that.setData({
                collectList: that.data.collectList
              });
            };

            daaty.CollectAddOrDelete(goodsId, that.data.type, null, successFay);
          }
        }
      });
    } else {

      wx.navigateTo({
        url: '/pages/goods/goods?id=' + goodsId
      });
    }
  },

  //按下事件开始  
  touchStart: function touchStart(e) {
    var that = this;
    that.setData({
      touchStart: e.timeStamp
    });
  },
  //按下事件结束  
  touchEnd: function touchEnd(e) {
    var that = this;
    that.setData({
      touchEnd: e.timeStamp
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Qud3hwIl0sIm5hbWVzIjpbImRhYXR5IiwicmVxdWlyZSIsImFwcCIsImdldEFwcCIsImRhdGEiLCJ0eXBlIiwiY29sbGVjdExpc3QiLCJvZmZzZXQiLCJsaW1pdCIsInRvdGFsUGFnZXMiLCJnZXRDb2xsZWN0TGlzdCIsInd4Iiwic2hvd0xvYWRpbmciLCJ0aXRsZSIsInRoYXQiLCJDb2xsZWN0TGlzdCIsInN1Y2Nlc3NGYXkiLCJyZXMiLCJzb3VyY2VPYmoiLCJjb25zb2xlIiwibG9nIiwic2V0RGF0YSIsImNvbmNhdCIsImhpZGVMb2FkaW5nIiwib25Mb2FkIiwib3B0aW9ucyIsInVzZXJpZCIsImdsb2JhbERhdGEiLCJ1c2VyIiwidXNlcklkIiwib25SZWFjaEJvdHRvbSIsInBhZ2UiLCJzaG93VG9hc3QiLCJpY29uIiwiZHVyYXRpb24iLCJvblJlYWR5Iiwib25TaG93Iiwib25IaWRlIiwib25VbmxvYWQiLCJvcGVuR29vZHMiLCJldmVudCIsImluZGV4IiwiY3VycmVudFRhcmdldCIsImRhdGFzZXQiLCJnb29kc0lkIiwidmFsdWVJZCIsInRvdWNoVGltZSIsInRvdWNoRW5kIiwidG91Y2hTdGFydCIsInNob3dNb2RhbCIsImNvbnRlbnQiLCJzdWNjZXNzIiwiY29uZmlybSIsInNwbGljZSIsIkNvbGxlY3RBZGRPckRlbGV0ZSIsIm5hdmlnYXRlVG8iLCJ1cmwiLCJlIiwidGltZVN0YW1wIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQUlBLFFBQVNDLFFBQVEscUJBQVIsQ0FBYjtBQUNBLElBQUlDLE1BQU1DLFFBQVY7O0FBTUdDLFFBQU07QUFDTEMsVUFBTSxDQUREO0FBRUxDLGlCQUFhLEVBRlI7QUFHTEMsWUFBUSxDQUhIO0FBSUxDLFdBQU8sRUFKRjtBQUtMQyxnQkFBWTtBQUxQLEc7QUFPUEMsZ0IsNEJBQWlCO0FBQ2ZDLE9BQUdDLFdBQUgsQ0FBZTtBQUNiQyxhQUFPO0FBRE0sS0FBZjtBQUdBLFFBQUlDLE9BQU8sSUFBWDtB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LENBQWM7QUFDWkMsYUFBSywyQkFBMkJaO0FBRHBCLE9BQWQ7QUFHRDtBQUNGLEc7O0FBQ0Q7QUFDQUksY0FBWSxvQkFBVVMsQ0FBVixFQUFhO0FBQ3ZCLFFBQUkzQyxPQUFPLElBQVg7QUFDQUEsU0FBS08sT0FBTCxDQUFhO0FBQ1gyQixrQkFBWVMsRUFBRUM7QUFESCxLQUFiO0FBR0QsRztBQUNEO0FBQ0FYLFlBQVUsa0JBQVVVLENBQVYsRUFBYTtBQUNyQixRQUFJM0MsT0FBTyxJQUFYO0FBQ0FBLFNBQUtPLE9BQUwsQ0FBYTtBQUNYMEIsZ0JBQVVVLEVBQUVDO0FBREQsS0FBYjtBQUdEIiwiZmlsZSI6ImNvbGxlY3Qud3hwIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGRhYXR5ID0gIHJlcXVpcmUoXCIuLi8uLi91dGlscy9hcGkyLmpzXCIpXG52YXIgYXBwID0gZ2V0QXBwKCk7XG5leHBvcnQgZGVmYXVsdCB7XG4gIGNvbmZpZzoge1xuICAgIG5hdmlnYXRpb25CYXJUaXRsZVRleHQ6ICfmiJHnmoTmlLbol48nLFxuICAgIHVzaW5nQ29tcG9uZW50czoge31cbiAgfSxcbiAgIGRhdGE6IHtcbiAgICB0eXBlOiAwLFxuICAgIGNvbGxlY3RMaXN0OiBbXSxcbiAgICBvZmZzZXQ6IDAsXG4gICAgbGltaXQ6IDEwLFxuICAgIHRvdGFsUGFnZXM6IDFcbiAgfSxcbiAgZ2V0Q29sbGVjdExpc3QoKSB7XG4gICAgd3guc2hvd0xvYWRpbmcoe1xuICAgICAgdGl0bGU6ICfliqDovb3kuK0uLi4nLFxuICAgIH0pO1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICBkYWF0eS5Db2xsZWN0TGlzdCggdGhhdC5kYXRhLnR5cGUsdGhhdC5kYXRhLm9mZnNldCx0aGF0LmRhdGEubGltaXQsbnVsbCxzdWNjZXNzRmF5KVxuICAgICAgZnVuY3Rpb24gc3VjY2Vzc0ZheShyZXMsIHNvdXJjZU9iail7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLmNvbGxlY3RMaXN0KVxuICAgICAgICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgICAgICAgIGNvbGxlY3RMaXN0OiB0aGF0LmRhdGEuY29sbGVjdExpc3QuY29uY2F0KHJlcy5kYXRhLmNvbGxlY3RMaXN0KSxcbiAgICAgICAgICAgICAgICB0b3RhbFBhZ2VzOiByZXMuZGF0YS50b3RhbFBhZ2VzXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgICB9XG4gIH0sXG4gIG9uTG9hZDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgdmFyIHVzZXJpZCA9IGFwcC5nbG9iYWxEYXRhLnVzZXIudXNlcklkXG4gICAgIHRoaXMuc2V0RGF0YSh7dXNlcmlkOnVzZXJpZH0pXG4gICAgIHRoaXMuZ2V0Q29sbGVjdExpc3QoKTtcbiAgfSxcbiAgb25SZWFjaEJvdHRvbSgpIHtcbiAgICBpZiAodGhpcy5kYXRhLnRvdGFsUGFnZXMgPiB0aGlzLmRhdGEucGFnZSkge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgcGFnZTogdGhpcy5kYXRhLnBhZ2UgKyAxXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZ2V0Q29sbGVjdExpc3QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfmsqHmnInmm7TlpJrnlKjmiLfmlLbol4/kuoYnLFxuICAgICAgICBpY29uOiAnbm9uZScsXG4gICAgICAgIGR1cmF0aW9uOiAyMDAwXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sICBcbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG4gIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge1xuICAgIC8vIOmhtemdoumakOiXj1xuXG4gIH0sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8g6aG16Z2i5YWz6ZetXG4gIH0sXG4gIG9wZW5Hb29kcyhldmVudCkge1xuICAgIFxuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICBsZXQgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgbGV0IGdvb2RzSWQgPSB0aGlzLmRhdGEuY29sbGVjdExpc3RbaW5kZXhdLnZhbHVlSWQ7XG5cbiAgICAvL+inpuaRuOaXtumXtOi3neemu+mhtemdouaJk+W8gOeahOavq+enkuaVsCAgXG4gICAgdmFyIHRvdWNoVGltZSA9IHRoYXQuZGF0YS50b3VjaEVuZCAtIHRoYXQuZGF0YS50b3VjaFN0YXJ0O1xuICAgIC8v5aaC5p6c5oyJ5LiL5pe26Ze05aSn5LqOMzUw5Li66ZW/5oyJICBcbiAgICBpZiAodG91Y2hUaW1lID4gMzUwKSB7XG4gICAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgICB0aXRsZTogJycsXG4gICAgICAgIGNvbnRlbnQ6ICfnoa7lrprliKDpmaTlkJfvvJ8nLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgaWYgKHJlcy5jb25maXJtKSB7XG4gICAgICAgICBkYWF0eS5Db2xsZWN0QWRkT3JEZWxldGUoZ29vZHNJZCx0aGF0LmRhdGEudHlwZSxudWxsLHN1Y2Nlc3NGYXkpXG4gICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NGYXkocmVzLCBzb3VyY2VPYmope1xuICAgICAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICAgICAgICAgICAgdGl0bGU6ICfliKDpmaTmiJDlip8nLFxuICAgICAgICAgICAgICAgICAgaWNvbjogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGF0LmRhdGEuY29sbGVjdExpc3Quc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgICBjb2xsZWN0TGlzdDogdGhhdC5kYXRhLmNvbGxlY3RMaXN0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBcbiAgICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgICB1cmw6ICcvcGFnZXMvZ29vZHMvZ29vZHM/aWQ9JyArIGdvb2RzSWQsXG4gICAgICB9KTtcbiAgICB9ICBcbiAgfSxcbiAgLy/mjInkuIvkuovku7blvIDlp4sgIFxuICB0b3VjaFN0YXJ0OiBmdW5jdGlvbiAoZSkge1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICB0aGF0LnNldERhdGEoe1xuICAgICAgdG91Y2hTdGFydDogZS50aW1lU3RhbXBcbiAgICB9KVxuICB9LFxuICAvL+aMieS4i+S6i+S7tue7k+adnyAgXG4gIHRvdWNoRW5kOiBmdW5jdGlvbiAoZSkge1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICB0aGF0LnNldERhdGEoe1xuICAgICAgdG91Y2hFbmQ6IGUudGltZVN0YW1wXG4gICAgfSlcbiAgfVxufSJdfQ==