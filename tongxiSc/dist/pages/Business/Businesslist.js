"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
// var daaty =  require("../../utils/data.js")
var daaty = require("../../utils/api2.js");
var uitil = require("../../utils/util.js");
var app = getApp();
exports.default = Page({
  data: {
    // asondata:daaty.datajsondb
    cardList: [],
    isend: false,
    limit: 10,
    offset: 0,
    type: 0,
    path1: ['../../common/assets/tab/kca1.png', '../../common/assets/tab/akb1.png'],
    path2: ['../../common/assets/tab/844090894838752016.png', '../../common/assets/tab/dianzan_icon_default@2x.png'],
    binindex: 0,
    // dzarr:['a','b'],
    user: ''
    // good:0
  },
  getImg: function getImg(fileList, headImg) {
    if (fileList == null || fileList == '') {
      return headImg;
    }
    for (var i = 0; i < fileList.length; i++) {
      var f = fileList[i];
      if (f.scoureType == 11) {
        headImg = app.globalData.imgUrl + f.fileUrl;
        break;
      }
    }
    return headImg;
  },
  cardList: function cardList() {
    app.loading();
    var thery = this;
    var user = app.globalData.user;
    daaty.list(user.userId, thery.data.offset, thery.data.limit, null, successFa2);
    function successFa2(data, sourceObj) {
      // console.log(data,55555)
      if (data.data == 0 || data.data == null || data.data == '') {
        thery.setData({ isend: true });
        wx.hideLoading();
        wx.hideNavigationBarLoading(); //完成停止加载
        wx.stopPullDownRefresh(); //停止下拉刷新
        app.hideLing();
        return;
      }
      var length = data.data.length;
      if (length < thery.data.limit) {
        thery.setData({ isend: true });
      } else {
        var offset = thery.data.offset + thery.data.limit;
        thery.setData({ isend: false, offset: offset });
      }
      var cardList = thery.data.cardList;
      for (var i = 0; i < data.data.length; i++) {
        var result = data.data[i];
        result.headImg = thery.getImg(result.fileList, result.headImg);
        cardList.push(result);
      }
      console.log(data.data, 'cardList', cardList);

      thery.setData({ cardList: cardList, user: user });

      wx.hideLoading();
      wx.hideNavigationBarLoading(); //完成停止加载
      wx.stopPullDownRefresh(); //停止下拉刷新
      app.hideLing();
    }
  },
  operationList: function operationList(operationType) {
    app.loading();
    var thery = this;
    var user = app.globalData.user;
    daaty.operationList(operationType, user.userId, thery.data.offset, thery.data.limit, null, successFa2);
    function successFa2(data, sourceObj) {
      if (data.data == 0 || data.data == null || data.data == '') {
        thery.setData({ isend: true });
        wx.hideLoading();
        wx.hideNavigationBarLoading(); //完成停止加载
        wx.stopPullDownRefresh(); //停止下拉刷新
        app.hideLing();
        return;
      }

      var length = data.data.length;
      if (length < thery.data.limit) {
        thery.setData({ isend: true });
      } else {
        var offset = thery.data.offset + thery.data.limit;
        thery.setData({ isend: false, offset: offset });
      }
      var cardList = thery.data.cardList;
      for (var i = 0; i < data.data.length; i++) {
        var result = data.data[i];
        result.headImg = thery.getImg(result.fileList, result.headImg);
        cardList.push(result);
      }
      thery.setData({ cardList: cardList });
      wx.hideLoading();
      wx.hideNavigationBarLoading(); //完成停止加载
      wx.stopPullDownRefresh(); //停止下拉刷新
      app.hideLing();
    }
  },
  onLoad: function onLoad(options) {
    var thery = this;
    console.log('options', options);
    app.checkLoginStatus();
    var type = options.type;
    thery.setData({ type: type });
    var title = '';
    switch (type) {
      case '1':
        title = '互动雷达';
        break;
      case '2':
        title = '被转发';
        break;
      case '3':
        title = '被收藏';
        break;
      case '4':
        title = '被浏览';
        break;
      default:
        title = '';
    }
    wx.setNavigationBarTitle({
      title: title
    });
    thery.getList();
  },
  getList: function getList() {
    var thery = this;
    app.checkLoginStatus();
    var type = thery.data.type;
    var title = '';
    // var user=app.globalData.user;
    switch (type) {
      case '1':
        this.cardList();
        break;
      case '2':
        this.operationList(4);
        break;
      case '3':
        this.operationList(1);
        break;
      case '4':
        this.operationList(3);
        break;
      default:
    }
  },
  /**
  * 页面相关事件处理函数--监听用户下拉动作
  */
  onPullDownRefresh: function onPullDownRefresh() {
    // console.log('下拉');
    var thery = this;
    thery.setData({ offset: 0 });
    wx.showNavigationBarLoading(); //在标题栏中显示加载
    this.getList();
  },
  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function onReachBottom() {
    console.log('上拉');
    var thery = this;
    if (!thery.data.isend) {
      this.getList(0);
    } else {
      wx.showToast({
        title: '没有更多数据'
      });
    }
  },
  aksening: function aksening() {
    wx.navigateTo({
      url: '../manage/manage'
    });
  },
  mewcwe: function mewcwe(e) {
    wx.navigateTo({
      url: '../details/details?uid=' + e.currentTarget.dataset.uid
    });
  },
  mewcwebox1: function mewcwebox1(e) {
    var indec = e.currentTarget.dataset.indec;
    var cars = e.currentTarget.dataset.cars;
    var thy = this;
    uitil.camcewr(cars, 1, indec, thy);
  },
  mewcwebox2: function mewcwebox2(e) {
    var indec = e.currentTarget.dataset.indec;
    var cars = e.currentTarget.dataset.cars;
    var thy = this;
    uitil.camcewr(cars, 2, indec, thy);
    this.setData({ binindex: indec });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJ1c2luZXNzbGlzdC53eHAiXSwibmFtZXMiOlsiZGFhdHkiLCJyZXF1aXJlIiwidWl0aWwiLCJhcHAiLCJnZXRBcHAiLCJkYXRhIiwiY2FyZExpc3QiLCJpc2VuZCIsImxpbWl0Iiwib2Zmc2V0IiwidHlwZSIsInBhdGgxIiwicGF0aDIiLCJiaW5pbmRleCIsInVzZXIiLCJnZXRJbWciLCJmaWxlTGlzdCIsImhlYWRJbWciLCJpIiwibGVuZ3RoIiwiZiIsInNjb3VyZVR5cGUiLCJnbG9iYWxEYXRhIiwiaW1nVXJsIiwiZmlsZVVybCIsImxvYWRpbmciLCJ0aGVyeSIsImxpc3QiLCJ1c2VySWQiLCJzdWNjZXNzRmEyIiwic291cmNlT2JqIiwic2V0RGF0YSIsInd4IiwiaGlkZUxvYWRpbmciLCJoaWRlTmF2aWdhdGlvbkJhckxvYWRpbmciLCJzdG9wUHVsbERvd25SZWZyZXNoIiwiaGlkZUxpbmciLCJyZXN1bHQiLCJwdXNoIiwiY29uc29sZSIsImxvZyIsIm9wZXJhdGlvbkxpc3QiLCJvcGVyYXRpb25UeXBlIiwib25Mb2FkIiwib3B0aW9ucyIsImNoZWNrTG9naW5TdGF0dXMiLCJ0aXRsZSIsInNldE5hdmlnYXRpb25CYXJUaXRsZSIsImdldExpc3QiLCJvblB1bGxEb3duUmVmcmVzaCIsInNob3dOYXZpZ2F0aW9uQmFyTG9hZGluZyIsIm9uUmVhY2hCb3R0b20iLCJzaG93VG9hc3QiLCJha3NlbmluZyIsIm5hdmlnYXRlVG8iLCJ1cmwiLCJtZXdjd2UiLCJlIiwiY3VycmVudFRhcmdldCIsImRhdGFzZXQiLCJ1aWQiLCJtZXdjd2Vib3gxIiwiaW5kZWMiLCJjYXJzIiwidGh5IiwiY2FtY2V3ciIsIm1ld2N3ZWJveDIiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQSxJQUFJQSxRQUFTQyxRQUFRLHFCQUFSLENBQWI7QUFDQSxJQUFJQyxRQUFRRCxRQUFRLHFCQUFSLENBQVo7QUFDQSxJQUFJRSxNQUFNQyxRQUFWOztBQVVFQyxRQUFNO0FBQ0o7QUFDQUMsY0FBUyxFQUZMO0FBR0pDLFdBQU0sS0FIRjtBQUlKQyxXQUFNLEVBSkY7QUFLSkMsWUFBTyxDQUxIO0FBTUpDLFVBQUssQ0FORDtBQU9KQyxXQUFNLENBQUMsa0NBQUQsRUFBb0Msa0NBQXBDLENBUEY7QUFRSkMsV0FBTSxDQUFDLGdEQUFELEVBQWtELHFEQUFsRCxDQVJGO0FBU0pDLGNBQVMsQ0FUTDtBQVVKO0FBQ0FDLFVBQUs7QUFDTDtBQVpJLEc7QUFjTkMsVUFBTyxnQkFBU0MsUUFBVCxFQUFrQkMsT0FBbEIsRUFBMEI7QUFDL0IsUUFBR0QsWUFBVSxJQUFWLElBQWdCQSxZQUFVLEVBQTdCLEVBQWdDO0FBQzlCLGFBQU9DLE9BQVA7QUFDRDtBQUNELFNBQUksSUFBSUMsSUFBRSxDQUFWLEVBQVlBLElBQUVGLFNBQVNHLE1BQXZCLEVBQThCRCxHQUE5QixFQUFrQztBQUNoQyxVQUFJRSxJQUFFSixTQUFTRSxDQUFULENBQU47QUFDQSxVQUFHRSxFQUFFQyxVQUFGLElBQWMsRUFBakIsRUFBb0I7QUFDbEJKLGtCQUFRZCxJQUFJbUIsVUFBSixDQUFlQyxNQUFmLEdBQXNCSCxFQUFFSSxPQUFoQztBQUNBO0FBQ0Q7QUFDRjtBQUNELFdBQU9QLE9BQVA7QUFDRCxHO0FBQ0RYLFlBQVMsb0JBQVU7QUFDZkgsUUFBSXNCLE9BQUo7QUFDQSxRQUFJQyxRQUFRLElBQVo7QUFDQSxRQUFJWixPQUFLWCxJQUFJbUIsVUFBSixDQUFlUixJQUF4QjtBQUNBZCxVQUFNMkIsSUFBTixDQUFXYixLQUFLYyxNQUFoQixFQUF1QkYsTUFBTXJCLElBQU4sQ0FBV0ksTUFBbEMsRUFBeUNpQixNQUFNckIsSUFBTixDQUFXRyxLQUFwRCxFQUEwRCxJQUExRCxFQUErRHFCLFVBQS9EO0FBQ0EsYUFBU0EsVUFBVCxDQUFvQnhCLElBQXBCLEVBQTBCeUIsU0FBMUIsRUFBb0M7QUFDbEM7QUFDQSxVQUFHekIsS0FBS0EsSUFBTCxJQUFXLENBQVgsSUFBY0EsS0FBS0EsSUFBTCxJQUFXLElBQXpCLElBQStCQSxLQUFLQSxJQUFMLElBQVcsRUFBN0MsRUFBZ0Q7QUFDOUNxQixjQUFNSyxPQUFOLENBQWMsRUFBQ3hCLE9BQU0sSUFBUCxFQUFkO0FBQ0F5QixXQUFHQyxXQUFIO0FBQ0FELFdBQUdFLHdCQUFILEdBSDhDLENBR2hCO0FBQzlCRixXQUFHRyxtQkFBSCxHQUo4QyxDQUlyQjtBQUN6QmhDLFlBQUlpQyxRQUFKO0FBQ0E7QUFDRDtBQUNELFVBQUlqQixTQUFPZCxLQUFLQSxJQUFMLENBQVVjLE1BQXJCO0FBQ0EsVUFBR0EsU0FBT08sTUFBTXJCLElBQU4sQ0FBV0csS0FBckIsRUFBMkI7QUFDekJrQixjQUFNSyxPQUFOLENBQWMsRUFBQ3hCLE9BQU0sSUFBUCxFQUFkO0FBQ0QsT0FGRCxNQUVLO0FBQ0wsWUFBSUUsU0FBT2lCLE1BQU1yQixJQUFOLENBQVdJLE1BQVgsR0FBa0JpQixNQUFNckIsSUFBTixDQUFXRyxLQUF4QztBQUNFa0IsY0FBTUssT0FBTixDQUFjLEVBQUN4QixPQUFNLEtBQVAsRUFBYUUsUUFBT0EsTUFBcEIsRUFBZDtBQUNEO0FBQ0QsVUFBSUgsV0FBU29CLE1BQU1yQixJQUFOLENBQVdDLFFBQXhCO0FBQ0EsV0FBSSxJQUFJWSxJQUFFLENBQVYsRUFBWUEsSUFBRWIsS0FBS0EsSUFBTCxDQUFVYyxNQUF4QixFQUErQkQsR0FBL0IsRUFBbUM7QUFDakMsWUFBSW1CLFNBQU9oQyxLQUFLQSxJQUFMLENBQVVhLENBQVYsQ0FBWDtBQUNBbUIsZUFBT3BCLE9BQVAsR0FBZVMsTUFBTVgsTUFBTixDQUFhc0IsT0FBT3JCLFFBQXBCLEVBQTZCcUIsT0FBT3BCLE9BQXBDLENBQWY7QUFDQVgsaUJBQVNnQyxJQUFULENBQWNELE1BQWQ7QUFDRDtBQUNERSxjQUFRQyxHQUFSLENBQVluQyxLQUFLQSxJQUFqQixFQUFzQixVQUF0QixFQUFpQ0MsUUFBakM7O0FBRUFvQixZQUFNSyxPQUFOLENBQWMsRUFBQ3pCLFVBQVNBLFFBQVYsRUFBbUJRLE1BQUtBLElBQXhCLEVBQWQ7O0FBRUFrQixTQUFHQyxXQUFIO0FBQ0FELFNBQUdFLHdCQUFILEdBNUJrQyxDQTRCSjtBQUM5QkYsU0FBR0csbUJBQUgsR0E3QmtDLENBNkJUO0FBQ3pCaEMsVUFBSWlDLFFBQUo7QUFDRDtBQUNKLEc7QUFDREssaUJBQWMsdUJBQVNDLGFBQVQsRUFBdUI7QUFDbkN2QyxRQUFJc0IsT0FBSjtBQUNFLFFBQUlDLFFBQVEsSUFBWjtBQUNBLFFBQUlaLE9BQUtYLElBQUltQixVQUFKLENBQWVSLElBQXhCO0FBQ0FkLFVBQU15QyxhQUFOLENBQW9CQyxhQUFwQixFQUFrQzVCLEtBQUtjLE1BQXZDLEVBQThDRixNQUFNckIsSUFBTixDQUFXSSxNQUF6RCxFQUFnRWlCLE1BQU1yQixJQUFOLENBQVdHLEtBQTNFLEVBQWlGLElBQWpGLEVBQXNGcUIsVUFBdEY7QUFDQSxhQUFTQSxVQUFULENBQW9CeEIsSUFBcEIsRUFBMEJ5QixTQUExQixFQUFvQztBQUNsQyxVQUFHekIsS0FBS0EsSUFBTCxJQUFXLENBQVgsSUFBY0EsS0FBS0EsSUFBTCxJQUFXLElBQXpCLElBQStCQSxLQUFLQSxJQUFMLElBQVcsRUFBN0MsRUFBZ0Q7QUFDOUNxQixjQUFNSyxPQUFOLENBQWMsRUFBQ3hCLE9BQU0sSUFBUCxFQUFkO0FBQ0F5QixXQUFHQyxXQUFIO0FBQ0FELFdBQUdFLHdCQUFILEdBSDhDLENBR2hCO0FBQzlCRixXQUFHRyxtQkFBSCxHQUo4QyxDQUlyQjtBQUN6QmhDLFlBQUlpQyxRQUFKO0FBQ0E7QUFDRDs7QUFFRCxVQUFJakIsU0FBT2QsS0FBS0EsSUFBTCxDQUFVYyxNQUFyQjtBQUNBLFVBQUdBLFNBQU9PLE1BQU1yQixJQUFOLENBQVdHLEtBQXJCLEVBQTJCO0FBQ3pCa0IsY0FBTUssT0FBTixDQUFjLEVBQUN4QixPQUFNLElBQVAsRUFBZDtBQUNELE9BRkQsTUFFSztBQUNKLFlBQUlFLFNBQU9pQixNQUFNckIsSUFBTixDQUFXSSxNQUFYLEdBQWtCaUIsTUFBTXJCLElBQU4sQ0FBV0csS0FBeEM7QUFDQ2tCLGNBQU1LLE9BQU4sQ0FBYyxFQUFDeEIsT0FBTSxLQUFQLEVBQWFFLFFBQU9BLE1BQXBCLEVBQWQ7QUFDRDtBQUNELFVBQUlILFdBQVNvQixNQUFNckIsSUFBTixDQUFXQyxRQUF4QjtBQUNBLFdBQUksSUFBSVksSUFBRSxDQUFWLEVBQVlBLElBQUViLEtBQUtBLElBQUwsQ0FBVWMsTUFBeEIsRUFBK0JELEdBQS9CLEVBQW1DO0FBQ2pDLFlBQUltQixTQUFPaEMsS0FBS0EsSUFBTCxDQUFVYSxDQUFWLENBQVg7QUFDQW1CLGVBQU9wQixPQUFQLEdBQWVTLE1BQU1YLE1BQU4sQ0FBYXNCLE9BQU9yQixRQUFwQixFQUE2QnFCLE9BQU9wQixPQUFwQyxDQUFmO0FBQ0FYLGlCQUFTZ0MsSUFBVCxDQUFjRCxNQUFkO0FBQ0Q7QUFDRFgsWUFBTUssT0FBTixDQUFjLEVBQUN6QixVQUFTQSxRQUFWLEVBQWQ7QUFDQTBCLFNBQUdDLFdBQUg7QUFDQUQsU0FBR0Usd0JBQUgsR0F6QmtDLENBeUJKO0FBQzlCRixTQUFHRyxtQkFBSCxHQTFCa0MsQ0EwQlQ7QUFDekJoQyxVQUFJaUMsUUFBSjtBQUNEO0FBQ0osRztBQUNETyxVQUFPLGdCQUFTQyxPQUFULEVBQWlCO0FBQ3RCLFFBQUlsQixRQUFRLElBQVo7QUFDQWEsWUFBUUMsR0FBUixDQUFZLFNBQVosRUFBc0JJLE9BQXRCO0FBQ0F6QyxRQUFJMEMsZ0JBQUo7QUFDQSxRQUFJbkMsT0FBS2tDLFFBQVFsQyxJQUFqQjtBQUNBZ0IsVUFBTUssT0FBTixDQUFjLEVBQUNyQixNQUFLQSxJQUFOLEVBQWQ7QUFDQSxRQUFJb0MsUUFBTSxFQUFWO0FBQ0EsWUFBT3BDLElBQVA7QUFFQSxXQUFLLEdBQUw7QUFDRW9DLGdCQUFNLE1BQU47QUFDQTtBQUNGLFdBQUssR0FBTDtBQUNFQSxnQkFBTSxLQUFOO0FBQ0E7QUFDRixXQUFLLEdBQUw7QUFDRUEsZ0JBQU0sS0FBTjtBQUNBO0FBQ0YsV0FBSyxHQUFMO0FBQ0VBLGdCQUFNLEtBQU47QUFDQTtBQUNGO0FBQ0VBLGdCQUFNLEVBQU47QUFmRjtBQWlCQWQsT0FBR2UscUJBQUgsQ0FBeUI7QUFDdkJELGFBQU9BO0FBRGdCLEtBQXpCO0FBR0FwQixVQUFNc0IsT0FBTjtBQUNELEc7QUFDREEsV0FBUSxtQkFBVTtBQUNoQixRQUFJdEIsUUFBUSxJQUFaO0FBQ0F2QixRQUFJMEMsZ0JBQUo7QUFDQSxRQUFJbkMsT0FBS2dCLE1BQU1yQixJQUFOLENBQVdLLElBQXBCO0FBQ0EsUUFBSW9DLFFBQU0sRUFBVjtBQUNBO0FBQ0EsWUFBT3BDLElBQVA7QUFFQSxXQUFLLEdBQUw7QUFDRSxhQUFLSixRQUFMO0FBQ0E7QUFDRixXQUFLLEdBQUw7QUFDRSxhQUFLbUMsYUFBTCxDQUFtQixDQUFuQjtBQUNBO0FBQ0YsV0FBSyxHQUFMO0FBQ0UsYUFBS0EsYUFBTCxDQUFtQixDQUFuQjtBQUNBO0FBQ0YsV0FBSyxHQUFMO0FBQ0UsYUFBS0EsYUFBTCxDQUFtQixDQUFuQjtBQUNBO0FBQ0Y7QUFkQTtBQWlCRCxHO0FBQ0E7OztBQUdEUSxxQkFBbUIsNkJBQVk7QUFDN0I7QUFDQSxRQUFJdkIsUUFBUSxJQUFaO0FBQ0FBLFVBQU1LLE9BQU4sQ0FBYyxFQUFDdEIsUUFBTyxDQUFSLEVBQWQ7QUFDQXVCLE9BQUdrQix3QkFBSCxHQUo2QixDQUlDO0FBQzlCLFNBQUtGLE9BQUw7QUFDRCxHO0FBQ0Q7OztBQUdBRyxpQkFBZSx5QkFBWTtBQUN6QlosWUFBUUMsR0FBUixDQUFZLElBQVo7QUFDQSxRQUFJZCxRQUFRLElBQVo7QUFDQSxRQUFJLENBQUNBLE1BQU1yQixJQUFOLENBQVdFLEtBQWhCLEVBQXVCO0FBQ3JCLFdBQUt5QyxPQUFMLENBQWEsQ0FBYjtBQUNELEtBRkQsTUFFTztBQUNMaEIsU0FBR29CLFNBQUgsQ0FBYTtBQUNYTixlQUFPO0FBREksT0FBYjtBQUdEO0FBQ0YsRztBQUNETyxZQUFTLG9CQUFVO0FBQ2pCckIsT0FBR3NCLFVBQUgsQ0FBYztBQUNaQyxXQUFJO0FBRFEsS0FBZDtBQUdELEc7QUFDREMsVUFBTyxnQkFBU0MsQ0FBVCxFQUFXO0FBQ2hCekIsT0FBR3NCLFVBQUgsQ0FBYztBQUNaQyxXQUFJLDRCQUEwQkUsRUFBRUMsYUFBRixDQUFnQkMsT0FBaEIsQ0FBd0JDO0FBRDFDLEtBQWQ7QUFHRCxHO0FBQ0RDLGNBQVcsb0JBQVNKLENBQVQsRUFBVztBQUNwQixRQUFJSyxRQUFRTCxFQUFFQyxhQUFGLENBQWdCQyxPQUFoQixDQUF3QkcsS0FBcEM7QUFDQSxRQUFJQyxPQUFPTixFQUFFQyxhQUFGLENBQWdCQyxPQUFoQixDQUF3QkksSUFBbkM7QUFDQSxRQUFJQyxNQUFNLElBQVY7QUFDQTlELFVBQU0rRCxPQUFOLENBQWNGLElBQWQsRUFBbUIsQ0FBbkIsRUFBcUJELEtBQXJCLEVBQTJCRSxHQUEzQjtBQUNELEc7QUFDREUsY0FBVyxvQkFBU1QsQ0FBVCxFQUFXO0FBQ2hCLFFBQUlLLFFBQVFMLEVBQUVDLGFBQUYsQ0FBZ0JDLE9BQWhCLENBQXdCRyxLQUFwQztBQUNBLFFBQUlDLE9BQU9OLEVBQUVDLGFBQUYsQ0FBZ0JDLE9BQWhCLENBQXdCSSxJQUFuQztBQUNBLFFBQUlDLE1BQU0sSUFBVjtBQUNBOUQsVUFBTStELE9BQU4sQ0FBY0YsSUFBZCxFQUFtQixDQUFuQixFQUFxQkQsS0FBckIsRUFBMkJFLEdBQTNCO0FBQ0EsU0FBS2pDLE9BQUwsQ0FBYSxFQUFDbEIsVUFBU2lELEtBQVYsRUFBYjtBQUNMIiwiZmlsZSI6IkJ1c2luZXNzbGlzdC53eHAiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB2YXIgZGFhdHkgPSAgcmVxdWlyZShcIi4uLy4uL3V0aWxzL2RhdGEuanNcIilcbnZhciBkYWF0eSA9ICByZXF1aXJlKFwiLi4vLi4vdXRpbHMvYXBpMi5qc1wiKVxudmFyIHVpdGlsID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWwuanNcIilcbnZhciBhcHAgPSBnZXRBcHAoKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgY29uZmlnOiB7XG4gICAgbmF2aWdhdGlvbkJhclRpdGxlVGV4dDogJycsXG4gICAgdXNpbmdDb21wb25lbnRzOiB7XG4gICAgICAnd3hjLWxvYWRtb3JlJzogJ0BtaW51aS93eGMtbG9hZG1vcmUnLFxuICAgICAgJ3d4Yy1pY29uJzogJ0BtaW51aS93eGMtaWNvbicsXG4gICAgICAnd3hjLXNlYXJjaCc6ICdAbWludWkvd3hjLXNlYXJjaCdcbiAgICB9XG4gIH0sXG4gIGRhdGE6IHtcbiAgICAvLyBhc29uZGF0YTpkYWF0eS5kYXRhanNvbmRiXG4gICAgY2FyZExpc3Q6W10sXG4gICAgaXNlbmQ6ZmFsc2UsXG4gICAgbGltaXQ6MTAsXG4gICAgb2Zmc2V0OjAsXG4gICAgdHlwZTowLFxuICAgIHBhdGgxOlsnLi4vLi4vY29tbW9uL2Fzc2V0cy90YWIva2NhMS5wbmcnLCcuLi8uLi9jb21tb24vYXNzZXRzL3RhYi9ha2IxLnBuZyddLFxuICAgIHBhdGgyOlsnLi4vLi4vY29tbW9uL2Fzc2V0cy90YWIvODQ0MDkwODk0ODM4NzUyMDE2LnBuZycsJy4uLy4uL2NvbW1vbi9hc3NldHMvdGFiL2RpYW56YW5faWNvbl9kZWZhdWx0QDJ4LnBuZyddLFxuICAgIGJpbmluZGV4OjAsXG4gICAgLy8gZHphcnI6WydhJywnYiddLFxuICAgIHVzZXI6JycsXG4gICAgLy8gZ29vZDowXG4gIH0sXG4gIGdldEltZzpmdW5jdGlvbihmaWxlTGlzdCxoZWFkSW1nKXtcbiAgICBpZihmaWxlTGlzdD09bnVsbHx8ZmlsZUxpc3Q9PScnKXtcbiAgICAgIHJldHVybiBoZWFkSW1nO1xuICAgIH1cbiAgICBmb3IodmFyIGk9MDtpPGZpbGVMaXN0Lmxlbmd0aDtpKyspe1xuICAgICAgbGV0IGY9ZmlsZUxpc3RbaV07XG4gICAgICBpZihmLnNjb3VyZVR5cGU9PTExKXtcbiAgICAgICAgaGVhZEltZz1hcHAuZ2xvYmFsRGF0YS5pbWdVcmwrZi5maWxlVXJsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhlYWRJbWc7XG4gIH0sXG4gIGNhcmRMaXN0OmZ1bmN0aW9uKCl7XG4gICAgICBhcHAubG9hZGluZygpO1xuICAgICAgdmFyIHRoZXJ5ID0gdGhpc1xuICAgICAgdmFyIHVzZXI9YXBwLmdsb2JhbERhdGEudXNlcjtcbiAgICAgIGRhYXR5Lmxpc3QodXNlci51c2VySWQsdGhlcnkuZGF0YS5vZmZzZXQsdGhlcnkuZGF0YS5saW1pdCxudWxsLHN1Y2Nlc3NGYTIpO1xuICAgICAgZnVuY3Rpb24gc3VjY2Vzc0ZhMihkYXRhLCBzb3VyY2VPYmope1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhLDU1NTU1KVxuICAgICAgICBpZihkYXRhLmRhdGE9PTB8fGRhdGEuZGF0YT09bnVsbHx8ZGF0YS5kYXRhPT0nJyl7XG4gICAgICAgICAgdGhlcnkuc2V0RGF0YSh7aXNlbmQ6dHJ1ZX0pXG4gICAgICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgICB3eC5oaWRlTmF2aWdhdGlvbkJhckxvYWRpbmcoKSAvL+WujOaIkOWBnOatouWKoOi9vVxuICAgICAgICAgIHd4LnN0b3BQdWxsRG93blJlZnJlc2goKSAvL+WBnOatouS4i+aLieWIt+aWsFxuICAgICAgICAgIGFwcC5oaWRlTGluZygpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGVuZ3RoPWRhdGEuZGF0YS5sZW5ndGg7XG4gICAgICAgIGlmKGxlbmd0aDx0aGVyeS5kYXRhLmxpbWl0KXtcbiAgICAgICAgICB0aGVyeS5zZXREYXRhKHtpc2VuZDp0cnVlfSlcbiAgICAgICAgfWVsc2V7XG4gICAgICAgIGxldCBvZmZzZXQ9dGhlcnkuZGF0YS5vZmZzZXQrdGhlcnkuZGF0YS5saW1pdDtcbiAgICAgICAgICB0aGVyeS5zZXREYXRhKHtpc2VuZDpmYWxzZSxvZmZzZXQ6b2Zmc2V0fSlcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2FyZExpc3Q9dGhlcnkuZGF0YS5jYXJkTGlzdDtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmRhdGEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgbGV0IHJlc3VsdD1kYXRhLmRhdGFbaV07XG4gICAgICAgICAgcmVzdWx0LmhlYWRJbWc9dGhlcnkuZ2V0SW1nKHJlc3VsdC5maWxlTGlzdCxyZXN1bHQuaGVhZEltZyk7XG4gICAgICAgICAgY2FyZExpc3QucHVzaChyZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEuZGF0YSwnY2FyZExpc3QnLGNhcmRMaXN0KVxuICAgICAgICBcbiAgICAgICAgdGhlcnkuc2V0RGF0YSh7Y2FyZExpc3Q6Y2FyZExpc3QsdXNlcjp1c2VyfSlcblxuICAgICAgICB3eC5oaWRlTG9hZGluZygpO1xuICAgICAgICB3eC5oaWRlTmF2aWdhdGlvbkJhckxvYWRpbmcoKSAvL+WujOaIkOWBnOatouWKoOi9vVxuICAgICAgICB3eC5zdG9wUHVsbERvd25SZWZyZXNoKCkgLy/lgZzmraLkuIvmi4nliLfmlrBcbiAgICAgICAgYXBwLmhpZGVMaW5nKCk7XG4gICAgICB9XG4gIH0sXG4gIG9wZXJhdGlvbkxpc3Q6ZnVuY3Rpb24ob3BlcmF0aW9uVHlwZSl7XG4gICAgYXBwLmxvYWRpbmcoKTtcbiAgICAgIHZhciB0aGVyeSA9IHRoaXNcbiAgICAgIHZhciB1c2VyPWFwcC5nbG9iYWxEYXRhLnVzZXI7XG4gICAgICBkYWF0eS5vcGVyYXRpb25MaXN0KG9wZXJhdGlvblR5cGUsdXNlci51c2VySWQsdGhlcnkuZGF0YS5vZmZzZXQsdGhlcnkuZGF0YS5saW1pdCxudWxsLHN1Y2Nlc3NGYTIpO1xuICAgICAgZnVuY3Rpb24gc3VjY2Vzc0ZhMihkYXRhLCBzb3VyY2VPYmope1xuICAgICAgICBpZihkYXRhLmRhdGE9PTB8fGRhdGEuZGF0YT09bnVsbHx8ZGF0YS5kYXRhPT0nJyl7XG4gICAgICAgICAgdGhlcnkuc2V0RGF0YSh7aXNlbmQ6dHJ1ZX0pXG4gICAgICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgICB3eC5oaWRlTmF2aWdhdGlvbkJhckxvYWRpbmcoKSAvL+WujOaIkOWBnOatouWKoOi9vVxuICAgICAgICAgIHd4LnN0b3BQdWxsRG93blJlZnJlc2goKSAvL+WBnOatouS4i+aLieWIt+aWsFxuICAgICAgICAgIGFwcC5oaWRlTGluZygpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBsZW5ndGg9ZGF0YS5kYXRhLmxlbmd0aDtcbiAgICAgICAgaWYobGVuZ3RoPHRoZXJ5LmRhdGEubGltaXQpe1xuICAgICAgICAgIHRoZXJ5LnNldERhdGEoe2lzZW5kOnRydWV9KVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgIGxldCBvZmZzZXQ9dGhlcnkuZGF0YS5vZmZzZXQrdGhlcnkuZGF0YS5saW1pdDtcbiAgICAgICAgICB0aGVyeS5zZXREYXRhKHtpc2VuZDpmYWxzZSxvZmZzZXQ6b2Zmc2V0fSlcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2FyZExpc3Q9dGhlcnkuZGF0YS5jYXJkTGlzdDtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmRhdGEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgbGV0IHJlc3VsdD1kYXRhLmRhdGFbaV07XG4gICAgICAgICAgcmVzdWx0LmhlYWRJbWc9dGhlcnkuZ2V0SW1nKHJlc3VsdC5maWxlTGlzdCxyZXN1bHQuaGVhZEltZyk7XG4gICAgICAgICAgY2FyZExpc3QucHVzaChyZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHRoZXJ5LnNldERhdGEoe2NhcmRMaXN0OmNhcmRMaXN0fSlcbiAgICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgd3guaGlkZU5hdmlnYXRpb25CYXJMb2FkaW5nKCkgLy/lrozmiJDlgZzmraLliqDovb1cbiAgICAgICAgd3guc3RvcFB1bGxEb3duUmVmcmVzaCgpIC8v5YGc5q2i5LiL5ouJ5Yi35pawXG4gICAgICAgIGFwcC5oaWRlTGluZygpO1xuICAgICAgfVxuICB9LFxuICBvbkxvYWQ6ZnVuY3Rpb24ob3B0aW9ucyl7XG4gICAgdmFyIHRoZXJ5ID0gdGhpc1xuICAgIGNvbnNvbGUubG9nKCdvcHRpb25zJyxvcHRpb25zKTtcbiAgICBhcHAuY2hlY2tMb2dpblN0YXR1cygpO1xuICAgIHZhciB0eXBlPW9wdGlvbnMudHlwZTtcbiAgICB0aGVyeS5zZXREYXRhKHt0eXBlOnR5cGV9KVxuICAgIHZhciB0aXRsZT0nJztcbiAgICBzd2l0Y2godHlwZSlcbiAgICB7XG4gICAgY2FzZSAnMSc6XG4gICAgICB0aXRsZT0n5LqS5Yqo6Zu36L6+J1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnMic6XG4gICAgICB0aXRsZT0n6KKr6L2s5Y+RJ1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnMyc6XG4gICAgICB0aXRsZT0n6KKr5pS26JePJ1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnNCc6XG4gICAgICB0aXRsZT0n6KKr5rWP6KeIJ1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRpdGxlPScnXG4gICAgfVxuICAgIHd4LnNldE5hdmlnYXRpb25CYXJUaXRsZSh7XG4gICAgICB0aXRsZTogdGl0bGVcbiAgICB9KVxuICAgIHRoZXJ5LmdldExpc3QoKTtcbiAgfSxcbiAgZ2V0TGlzdDpmdW5jdGlvbigpe1xuICAgIHZhciB0aGVyeSA9IHRoaXNcbiAgICBhcHAuY2hlY2tMb2dpblN0YXR1cygpO1xuICAgIHZhciB0eXBlPXRoZXJ5LmRhdGEudHlwZVxuICAgIHZhciB0aXRsZT0nJztcbiAgICAvLyB2YXIgdXNlcj1hcHAuZ2xvYmFsRGF0YS51c2VyO1xuICAgIHN3aXRjaCh0eXBlKVxuICAgIHtcbiAgICBjYXNlICcxJzpcbiAgICAgIHRoaXMuY2FyZExpc3QoKVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnMic6XG4gICAgICB0aGlzLm9wZXJhdGlvbkxpc3QoNCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICczJzpcbiAgICAgIHRoaXMub3BlcmF0aW9uTGlzdCgxKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJzQnOlxuICAgICAgdGhpcy5vcGVyYXRpb25MaXN0KDMpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICB9XG4gICAgXG4gIH0sXG4gICAvKipcbiAqIOmhtemdouebuOWFs+S6i+S7tuWkhOeQhuWHveaVsC0t55uR5ZCs55So5oi35LiL5ouJ5Yqo5L2cXG4gKi9cbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZygn5LiL5ouJJyk7XG4gICAgdmFyIHRoZXJ5ID0gdGhpc1xuICAgIHRoZXJ5LnNldERhdGEoe29mZnNldDowfSlcbiAgICB3eC5zaG93TmF2aWdhdGlvbkJhckxvYWRpbmcoKSAvL+WcqOagh+mimOagj+S4reaYvuekuuWKoOi9vVxuICAgIHRoaXMuZ2V0TGlzdCgpXG4gIH0sXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zb2xlLmxvZygn5LiK5ouJJyk7XG4gICAgdmFyIHRoZXJ5ID0gdGhpc1xuICAgIGlmICghdGhlcnkuZGF0YS5pc2VuZCkge1xuICAgICAgdGhpcy5nZXRMaXN0KDApXG4gICAgfSBlbHNlIHtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOiAn5rKh5pyJ5pu05aSa5pWw5o2uJyxcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuICBha3NlbmluZzpmdW5jdGlvbigpe1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOicuLi9tYW5hZ2UvbWFuYWdlJ1xuICAgIH0pXG4gIH0sXG4gIG1ld2N3ZTpmdW5jdGlvbihlKXtcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDonLi4vZGV0YWlscy9kZXRhaWxzP3VpZD0nK2UuY3VycmVudFRhcmdldC5kYXRhc2V0LnVpZFxuICAgIH0pXG4gIH0sXG4gIG1ld2N3ZWJveDE6ZnVuY3Rpb24oZSl7XG4gICAgdmFyIGluZGVjID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZWNcbiAgICB2YXIgY2FycyA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmNhcnNcbiAgICB2YXIgdGh5ID0gdGhpc1xuICAgIHVpdGlsLmNhbWNld3IoY2FycywxLGluZGVjLHRoeSlcbiAgfSxcbiAgbWV3Y3dlYm94MjpmdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIGluZGVjID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZWNcbiAgICAgICAgdmFyIGNhcnMgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5jYXJzXG4gICAgICAgIHZhciB0aHkgPSB0aGlzXG4gICAgICAgIHVpdGlsLmNhbWNld3IoY2FycywyLGluZGVjLHRoeSlcbiAgICAgICAgdGhpcy5zZXREYXRhKHtiaW5pbmRleDppbmRlY30pXG4gIH1cbn0iXX0=