"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var daaty = require("../../utils/api2.js");
var utily = require("../../utils/util.js");
var app = getApp();
exports.default = Page({
  data: {
    footprintList: [],
    offset: 0,
    limit: 10,
    totalPages: 1
  },
  getFootprintList: function getFootprintList() {
    wx.showLoading({
      title: '加载中...'
    });
    var that = this;
    daaty.FootprintList(this.data.userid, that.data.offset, that.data.limit, null, successFay);
    function successFay(res, sourceObj) {
      for (var i = 0; i < res.data.footprintList.length; i++) {
        res.data.footprintList[i].addTime = utily.getDate(res.data.footprintList[i].addTime);
      }
      var f1 = that.data.footprintList;
      var f2 = res.data.footprintList;
      console.log(f1, 'f1');
      for (var _i = 0; _i < f2.length; _i++) {
        var last = f1.length - 1;
        if (last >= 0 && f1[last][0].addTime === f2[_i].addTime) {
          f1[last].push(f2[_i]);
        } else {
          var tmp = [];
          tmp.push(f2[_i]);
          f1.push(tmp);
        }
      }

      that.setData({
        footprintList: f1,
        totalPages: res.data.totalPages
      });
      wx.hideLoading();
    }
  },
  deleteItem: function deleteItem(event) {
    var that = this;
    var index = event.currentTarget.dataset.index;
    var iindex = event.currentTarget.dataset.iindex;
    var goodsId = this.data.footprintList[index][iindex].id;
    var touchTime = that.data.touchEnd - that.data.touchStart;
    console.log(touchTime);
    //如果按下时间大于350为长按  
    if (touchTime > 350) {
      wx.showModal({
        title: '',
        content: '要删除所选足迹？',
        success: function success(res) {
          if (res.confirm) {
            var successFay = function successFay(res, sourceObj) {
              wx.showToast({
                title: '删除成功',
                icon: 'success',
                duration: 2000
              });
              that.data.footprintList[index].splice(iindex, 1);
              if (that.data.footprintList[index].length == 0) {
                that.data.footprintList.splice(index, 1);
              }
              that.setData({
                footprintList: that.data.footprintList
              });
            };

            daaty.FootprintDelete(goodsId, null, successFay);
          }
        }
      });
    } else {
      wx.navigateTo({
        url: '/pages/goods/goods?id=' + goodsId
      });
    }
  },

  onLoad: function onLoad(options) {
    var userid = app.globalData.user.userId;
    this.setData({ userid: userid });
    this.getFootprintList();
  },
  onReachBottom: function onReachBottom() {
    if (this.data.totalPages > this.data.page) {
      this.setData({
        page: this.data.page + 1
      });
      this.getFootprintList();
    } else {
      wx.showToast({
        title: '没有更多用户足迹了',
        icon: 'none',
        duration: 2000
      });
      return false;
    }
  },

  onReady: function onReady() {},
  onShow: function onShow() {},
  onHide: function onHide() {
    // 页面隐藏

  },
  onUnload: function onUnload() {
    // 页面关闭
  },
  //按下事件开始  
  touchStart: function touchStart(e) {
    var that = this;
    that.setData({
      touchStart: e.timeStamp
    });
    console.log(e.timeStamp + '- touchStart');
  },
  //按下事件结束  
  touchEnd: function touchEnd(e) {
    var that = this;
    that.setData({
      touchEnd: e.timeStamp
    });
    console.log(e.timeStamp + '- touchEnd');
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3RwcmludC53eHAiXSwibmFtZXMiOlsiZGFhdHkiLCJyZXF1aXJlIiwidXRpbHkiLCJhcHAiLCJnZXRBcHAiLCJkYXRhIiwiZm9vdHByaW50TGlzdCIsIm9mZnNldCIsImxpbWl0IiwidG90YWxQYWdlcyIsImdldEZvb3RwcmludExpc3QiLCJ3eCIsInNob3dMb2FkaW5nIiwidGl0bGUiLCJ0aGF0IiwiRm9vdHByaW50TGlzdCIsInVzZXJpZCIsInN1Y2Nlc3NGYXkiLCJyZXMiLCJzb3VyY2VPYmoiLCJpIiwibGVuZ3RoIiwiYWRkVGltZSIsImdldERhdGUiLCJmMSIsImYyIiwiY29uc29sZSIsImxvZyIsImxhc3QiLCJwdXNoIiwidG1wIiwic2V0RGF0YSIsImhpZGVMb2FkaW5nIiwiZGVsZXRlSXRlbSIsImV2ZW50IiwiaW5kZXgiLCJjdXJyZW50VGFyZ2V0IiwiZGF0YXNldCIsImlpbmRleCIsImdvb2RzSWQiLCJpZCIsInRvdWNoVGltZSIsInRvdWNoRW5kIiwidG91Y2hTdGFydCIsInNob3dNb2RhbCIsImNvbnRlbnQiLCJzdWNjZXNzIiwiY29uZmlybSIsInNob3dUb2FzdCIsImljb24iLCJkdXJhdGlvbiIsInNwbGljZSIsIkZvb3RwcmludERlbGV0ZSIsIm5hdmlnYXRlVG8iLCJ1cmwiLCJvbkxvYWQiLCJvcHRpb25zIiwiZ2xvYmFsRGF0YSIsInVzZXIiLCJ1c2VySWQiLCJvblJlYWNoQm90dG9tIiwicGFnZSIsIm9uUmVhZHkiLCJvblNob3ciLCJvbkhpZGUiLCJvblVubG9hZCIsImUiLCJ0aW1lU3RhbXAiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBSUEsUUFBU0MsUUFBUSxxQkFBUixDQUFiO0FBQ0EsSUFBTUMsUUFBU0QsUUFBUSxxQkFBUixDQUFmO0FBQ0EsSUFBSUUsTUFBTUMsUUFBVjs7QUFNRUMsUUFBTTtBQUNKQyxtQkFBZSxFQURYO0FBRUpDLFlBQVEsQ0FGSjtBQUdKQyxXQUFPLEVBSEg7QUFJSkMsZ0JBQVk7QUFKUixH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QVEsa0JBQVksQ0FFbkIsQztBQUNEQyxVQUFRLGtCQUFZO0FBQ2xCOztBQUVELEc7QUFDREMsWUFBVSxvQkFBWTtBQUNwQjtBQUNELEc7QUFDRDtBQUNBdEIsY0FBWSxvQkFBVXVCLENBQVYsRUFBYTtBQUN2QixRQUFJcEQsT0FBTyxJQUFYO0FBQ0FBLFNBQUtpQixPQUFMLENBQWE7QUFDWFksa0JBQVl1QixFQUFFQztBQURILEtBQWI7QUFHQXpDLFlBQVFDLEdBQVIsQ0FBWXVDLEVBQUVDLFNBQUYsR0FBYyxjQUExQjtBQUNELEc7QUFDRDtBQUNBekIsWUFBVSxrQkFBVXdCLENBQVYsRUFBYTtBQUNyQixRQUFJcEQsT0FBTyxJQUFYO0FBQ0FBLFNBQUtpQixPQUFMLENBQWE7QUFDWFcsZ0JBQVV3QixFQUFFQztBQURELEtBQWI7QUFHQXpDLFlBQVFDLEdBQVIsQ0FBWXVDLEVBQUVDLFNBQUYsR0FBYyxZQUExQjtBQUNEIiwiZmlsZSI6ImZvb3RwcmludC53eHAiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGFhdHkgPSAgcmVxdWlyZShcIi4uLy4uL3V0aWxzL2FwaTIuanNcIilcbmNvbnN0IHV0aWx5ID0gIHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsLmpzXCIpXG52YXIgYXBwID0gZ2V0QXBwKCk7XG5leHBvcnQgZGVmYXVsdCB7XG4gIGNvbmZpZzoge1xuICAgIG5hdmlnYXRpb25CYXJUaXRsZVRleHQ6ICfmiJHnmoTotrPov7knLFxuICAgIHVzaW5nQ29tcG9uZW50czoge31cbiAgfSxcbiAgZGF0YToge1xuICAgIGZvb3RwcmludExpc3Q6IFtdLFxuICAgIG9mZnNldDogMCxcbiAgICBsaW1pdDogMTAsXG4gICAgdG90YWxQYWdlczogMVxuICB9LFxuICBnZXRGb290cHJpbnRMaXN0KCkge1xuICAgIHd4LnNob3dMb2FkaW5nKHtcbiAgICAgIHRpdGxlOiAn5Yqg6L295LitLi4uJyxcbiAgICB9KTtcbiAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgIGRhYXR5LkZvb3RwcmludExpc3QodGhpcy5kYXRhLnVzZXJpZCx0aGF0LmRhdGEub2Zmc2V0LHRoYXQuZGF0YS5saW1pdCxudWxsLHN1Y2Nlc3NGYXkpXG4gICAgICBmdW5jdGlvbiBzdWNjZXNzRmF5KHJlcyxzb3VyY2VPYmope1xuICAgICAgICBmb3IodmFyIGk9MDtpPHJlcy5kYXRhLmZvb3RwcmludExpc3QubGVuZ3RoO2krKyl7XG4gICAgICAgICAgcmVzLmRhdGEuZm9vdHByaW50TGlzdFtpXS5hZGRUaW1lID0gdXRpbHkuZ2V0RGF0ZShyZXMuZGF0YS5mb290cHJpbnRMaXN0W2ldLmFkZFRpbWUpXG4gICAgICAgIH1cbiAgICAgICAgbGV0IGYxID0gdGhhdC5kYXRhLmZvb3RwcmludExpc3Q7XG4gICAgICAgIGxldCBmMiA9IHJlcy5kYXRhLmZvb3RwcmludExpc3Q7XG4gICAgICAgIGNvbnNvbGUubG9nKGYxLCdmMScpXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBsZXQgbGFzdCA9IGYxLmxlbmd0aCAtIDE7XG4gICAgICAgICAgaWYgKGxhc3QgPj0gMCAmJiBmMVtsYXN0XVswXS5hZGRUaW1lID09PSBmMltpXS5hZGRUaW1lKSB7XG4gICAgICAgICAgICBmMVtsYXN0XS5wdXNoKGYyW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGxldCB0bXAgPSBbXTtcbiAgICAgICAgICAgIHRtcC5wdXNoKGYyW2ldKVxuICAgICAgICAgICAgZjEucHVzaCh0bXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgZm9vdHByaW50TGlzdDogZjEsXG4gICAgICAgICAgdG90YWxQYWdlczogcmVzLmRhdGEudG90YWxQYWdlc1xuICAgICAgICB9KTtcbiAgICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgIH1cbiAgfSxcbiAgZGVsZXRlSXRlbSAoZXZlbnQpe1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICBsZXQgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgbGV0IGlpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5paW5kZXg7XG4gICAgbGV0IGdvb2RzSWQgPSB0aGlzLmRhdGEuZm9vdHByaW50TGlzdFtpbmRleF1baWluZGV4XS5pZDtcbiAgICB2YXIgdG91Y2hUaW1lID0gdGhhdC5kYXRhLnRvdWNoRW5kIC0gdGhhdC5kYXRhLnRvdWNoU3RhcnQ7XG4gICAgY29uc29sZS5sb2codG91Y2hUaW1lKTtcbiAgICAvL+WmguaenOaMieS4i+aXtumXtOWkp+S6jjM1MOS4uumVv+aMiSAgXG4gICAgaWYgKHRvdWNoVGltZSA+IDM1MCkge1xuICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICBjb250ZW50OiAn6KaB5Yig6Zmk5omA6YCJ6Laz6L+577yfJyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgIGlmIChyZXMuY29uZmlybSkge1xuICAgICAgICAgICAgIGRhYXR5LkZvb3RwcmludERlbGV0ZShnb29kc0lkLG51bGwsc3VjY2Vzc0ZheSlcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzRmF5KHJlcyxzb3VyY2VPYmope1xuICAgICAgICAgICAgICAgICAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5Yig6Zmk5oiQ5YqfJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMjAwMFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZGF0YS5mb290cHJpbnRMaXN0W2luZGV4XS5zcGxpY2UoaWluZGV4LCAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoYXQuZGF0YS5mb290cHJpbnRMaXN0W2luZGV4XS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZGF0YS5mb290cHJpbnRMaXN0LnNwbGljZShpbmRleCwgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RwcmludExpc3Q6IHRoYXQuZGF0YS5mb290cHJpbnRMaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgICB1cmw6ICcvcGFnZXMvZ29vZHMvZ29vZHM/aWQ9JyArIGdvb2RzSWQsXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gIH0sXG4gIG9uTG9hZDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICB2YXIgdXNlcmlkID0gYXBwLmdsb2JhbERhdGEudXNlci51c2VySWRcbiAgICAgdGhpcy5zZXREYXRhKHt1c2VyaWQ6dXNlcmlkfSlcbiAgICB0aGlzLmdldEZvb3RwcmludExpc3QoKTtcbiAgfSxcbiAgb25SZWFjaEJvdHRvbSgpIHtcbiAgICBpZiAodGhpcy5kYXRhLnRvdGFsUGFnZXMgPiB0aGlzLmRhdGEucGFnZSkge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgcGFnZTogdGhpcy5kYXRhLnBhZ2UgKyAxXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZ2V0Rm9vdHByaW50TGlzdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ+ayoeacieabtOWkmueUqOaIt+i2s+i/ueS6hicsXG4gICAgICAgIGljb246ICdub25lJyxcbiAgICAgICAgZHVyYXRpb246IDIwMDBcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSxcbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG4gIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge1xuICAgIC8vIOmhtemdoumakOiXj1xuXG4gIH0sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8g6aG16Z2i5YWz6ZetXG4gIH0sXG4gIC8v5oyJ5LiL5LqL5Lu25byA5aeLICBcbiAgdG91Y2hTdGFydDogZnVuY3Rpb24gKGUpIHtcbiAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgdGhhdC5zZXREYXRhKHtcbiAgICAgIHRvdWNoU3RhcnQ6IGUudGltZVN0YW1wXG4gICAgfSlcbiAgICBjb25zb2xlLmxvZyhlLnRpbWVTdGFtcCArICctIHRvdWNoU3RhcnQnKVxuICB9LFxuICAvL+aMieS4i+S6i+S7tue7k+adnyAgXG4gIHRvdWNoRW5kOiBmdW5jdGlvbiAoZSkge1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICB0aGF0LnNldERhdGEoe1xuICAgICAgdG91Y2hFbmQ6IGUudGltZVN0YW1wXG4gICAgfSlcbiAgICBjb25zb2xlLmxvZyhlLnRpbWVTdGFtcCArICctIHRvdWNoRW5kJylcbiAgfVxufSJdfQ==